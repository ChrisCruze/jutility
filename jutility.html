<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jutility</title>
    <link href="https://cruz.site44.com/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cruz.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="https://cruz.site44.com/css/animate.css" rel="stylesheet">
    <link href=https://rawgit.com/vderm9/jutility/master/style.css rel="stylesheet">
    <link href='https://cruzco.site44.com/lib/fullcalendar.min.css' rel='stylesheet' />
    <link href='https://cruzco.site44.com/lib/fullcalendar.print.min.css' rel='stylesheet' media='print' />
    <link href='https://cruzco.site44.com/lib/scheduler.min.css' rel='stylesheet' />
    <link href='https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css' rel='stylesheet' />
    <link href="https://cruz.site44.com/css/plugins/dataTables/datatables.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.css" />
    <link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
    <link rel="stylesheet" href="https://cdn.rawgit.com/vderm9/jutility/master/css/editor.dataTables.min.css">
    <script src="https://cruz.site44.com/js/jquery-3.1.1.min.js"></script>
    <script src="https://cruz.site44.com/js/bootstrap.min.js"></script>
    <script src="https://cruz.site44.com/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="https://cruz.site44.com/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    <!-- Flot -->
    <script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.js"></script>
    <script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
    <script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.spline.js"></script>
    <script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.resize.js"></script>
    <script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.pie.js"></script>
    <script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.symbol.js"></script>
    <script src="https://cruz.site44.com/js/plugins/flot/curvedLines.js"></script>
    <!-- Peity -->
    <script src="https://cruz.site44.com/js/plugins/peity/jquery.peity.min.js"></script>
    <!-- Custom and plugin javascript -->
    <script src="https://cruz.site44.com/js/inspinia.js"></script>
    <script src="https://cruz.site44.com/js/plugins/pace/pace.min.js"></script>
    <!-- jQuery UI -->
    <script src="https://cruz.site44.com/js/plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- Jvectormap -->
    <script src="https://cruz.site44.com/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
    <script src="https://cruz.site44.com/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
    <!-- Sparkline -->
    <script src="https://cruz.site44.com/js/plugins/sparkline/jquery.sparkline.min.js"></script>
    <!-- ChartJS-->
    <script src="https://cruz.site44.com/js/plugins/chartJs/Chart.min.js"></script>
    <!-- CodeMirror-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/mode/javascript/javascript.js"></script>
    <!-- FirebaseJS-->
    <script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
    <script>
    firebase.initializeApp({apiKey: "AIzaSyApJBfnH0j3TSugzEABiMFkI_tU_XXeGzg", authDomain: "shippy-ac235.firebaseapp.com", databaseURL: "https://shippy-ac235.firebaseio.com"});
    </script>
    <script src="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.css" />
    <!-- Underscore-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src='https://cruzco.site44.com/lib/moment.min.js'></script>
    <script src='http://isaaccambron.com/twix.js/twix.js/dist/twix.min.js'></script>
    <script src='https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js'></script>
    <script src="https://cruz.site44.com/js/plugins/dataTables/datatables.min.js"></script>
    <script src="https://cruzco.site44.com/js/plugins/fullcalendar/fullcalendar.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/api/sum().js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/sorting/datetime-moment.js"></script>
    <script type="text/javascript" src="https://cdn.rawgit.com/vderm9/jutility/master/js/dataTables.editor.min.js"></script>
    <link href="https://cruz.site44.com/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cruz.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="https://cruz.site44.com/css/animate.css" rel="stylesheet">
    <link href="https://cruz.site44.com/css/style.css" rel="stylesheet">
    <script src="https://rawgit.com/vderm9/jutility/master/jutility.js"></script>
    <!--     <script src="https://rawgit.com/ChrisCruze/jutility/master/jutility.js"></script>
    -->    <script src="jutility.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.1.0/webcomponents-hi.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/4.3.7/papaparse.min.js"></script>
    <style>
    #customForm {
    display: flex;
    flex-flow: row wrap;
    }
    
    #customForm fieldset {
    flex: 1;
    border: 1px solid #aaa;
    margin: 0.5em;
    }
    
    #customForm fieldset legend {
    padding: 5px 20px;
    border: 1px solid #aaa;
    font-weight: bold;
    }
    
    #customForm fieldset.name {
    flex: 2 100%;
    }
    
    #customForm fieldset.name legend {
    background: #bfffbf;
    }
    
    #customForm fieldset.office legend {
    background: #ffffbf;
    }
    
    #customForm fieldset.hr legend {
    background: #ffbfbf;
    }
    
    #customForm div.DTE_Field {
    padding: 5px;
    }
    </style>
  </head>
  <body>
    <div id="wrapper">
    <div id="page-wrapper" class="gray-bg">

      <div class="wrapper wrapper-content">
        <div id='main_content'>
          <div class="container">
            <div class="row">
              <div class="col-lg-12">
                <div class="ibox float-e-margins">
                  <div class="ibox-title">
                    <div id="total_amount"></div>
                  </div>
                  <div class="ibox-content">
                    <div class="table-responsive">
                      <table id="table" class="table table-striped table-bordered table-hover dataTables-example">
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
      <script>
      //define the firebase node
      omni_node = 'jutility'
      var dbRef = dbRef||firebase.database();
      var FirebaseRef = dbRef.ref('omni').child(omni_node)
      //determine sorting order
      $.fn.dataTable.ext.type.order["date-format-moment-pre"] = function(d) {
      if (d == 'null'){
      r = moment().utc()
      }
      else {
      r = moment(d).utc();
      }
      return r;
      };
      function array_dictionary_customize(item, index) {
      item["DT_RowId"] = item.name;
      }
      url = "functions.csv"
      //url = "https://rawgit.com/ChrisCruze/jutility/master/functions.csv"
      input_data = papa_parse_array(url)
      input_data.splice(0,1)
      input_data.forEach(array_dictionary_customize);
      input_data = input_data.filter(function(D){return D['DT_RowId'] != undefined})
      array = firebase_array_integrate(array,"https://shippy-ac235.firebaseio.com/omni/"+omni_node+".json","DT_RowId",['status','notes','created_date','timestamp'])
      //input_data.forEach(function(i){key_check_func(['fullName'],i)})
      editor = new $.fn.dataTable.Editor( {
      table: "#table",
      fields: [{ label: "status:", name: "status" },{ label: "notes:", name: "notes" }]
      });
      editor.on( 'postSubmit', function (e, json, data, action, xhr) {
      json_array = json.data
      json_array.forEach(function(D){
      console.log(D)
      record_id = D["DT_RowId"];
      D["timestamp"] = moment().format();
      if (D["created_date"] == 'null'){
      D["created_date"] = moment().format();
      }
      console.log(D)
      FirebaseRef.child(record_id).set(D);
      })
      });
      function date_format_check_in(td, cellData, rowData, row, col) {
      date_format = moment(cellData).format("MM/DD/YY hh:mmA");
      $(td).html(date_format);
      }
      function url_formulate(td, cellData, rowData, row, col) {
      url = "https://github.com/ChrisCruze/jutility/blob/master/"
      url = url + rowData['folder_name'] + "/" + rowData["file_name"]
      new_link = "<a href='"+url+"'>"+cellData+"</a>"
      $(td).html(new_link)
      }
      //https://github.com/ChrisCruze/jutility/blob/master/function/array_functions.js
      table_example = $('#table').DataTable({
      paging:false,
      dom: '<"html5buttons"B>lTfgitp',
      data: input_data,
      columns: [
      {data:'name',title:'name',name:'name',visible:true,createdCell:url_formulate},
      {data:'code',title:'code',name:'code',visible:false},
      {data:'folder_name',title:'folder_name',name:'folder_name',visible:false},
      {data:'file_name',title:'file_name',name:'file_name',visible:true},
      {data:'description',title:'description',name:'description',visible:true},
      {data:'timestamp',title:'timestamp',name:'timestamp',visible:false,createdCell:date_format_check_in,type:'date-format-moment'},
      {data:'created_date',title:'created_date',name:'created_date',visible:true,createdCell:date_format_check_in,type:'date-format-moment'},
      {
      data: "status",
      title: "status",
      visible: true,
      name: "status"
      },
      {
      data: "notes",
      title: "notes",
      visible: true,
      name: "notes"
      },
      {
      data: "DT_RowId",
      title: "DT_RowId",
      visible: false,
      name: "DT_RowId"
      }
      
      ],
      select: true,
      colReorder: true,
      order: [6, "desc"],
      buttons: [
      {extend: 'excel', title: document.title},
      {extend: 'colvis', title: document.title},
      { extend: "create", editor: editor },
      { extend: "edit",   editor: editor },
      { extend: "remove", editor: editor }
      ]
      });
      replace_side_panel_platform_omni()
      </script>
    </body>
  </html>