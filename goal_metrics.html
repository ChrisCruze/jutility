<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cruz Control</title>
<link href="https://cruz.site44.com/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cruz.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
<link href="https://cruz.site44.com/css/animate.css" rel="stylesheet">
<link href=https://rawgit.com/vderm9/jutility/master/style.css rel="stylesheet">
<link href='https://cruzco.site44.com/lib/fullcalendar.min.css' rel='stylesheet' />
<link href='https://cruzco.site44.com/lib/fullcalendar.print.min.css' rel='stylesheet' media='print' />
<link href='https://cruzco.site44.com/lib/scheduler.min.css' rel='stylesheet' />
<link href='https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css' rel='stylesheet' />
<link href="https://cruz.site44.com/css/plugins/dataTables/datatables.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.css"/>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.css" />
<link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />
<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
<link rel="stylesheet" href="https://cdn.rawgit.com/vderm9/jutility/master/css/editor.dataTables.min.css">
<!-- Mainly scripts -->
<script src="https://cruz.site44.com/js/jquery-3.1.1.min.js"></script>
<script src="https://cruz.site44.com/js/bootstrap.min.js"></script>
<script src="https://cruz.site44.com/js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="https://cruz.site44.com/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<!-- Flot -->
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.spline.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.resize.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.pie.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.symbol.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/curvedLines.js"></script>

<!-- Peity -->
<script src="https://cruz.site44.com/js/plugins/peity/jquery.peity.min.js"></script>
<script src="https://cruz.site44.com/js/demo/peity-demo.js"></script>

<!-- Custom and plugin javascript -->
<script src="https://cruz.site44.com/js/inspinia.js"></script>
<script src="https://cruz.site44.com/js/plugins/pace/pace.min.js"></script>

<!-- jQuery UI -->
<script src="https://cruz.site44.com/js/plugins/jquery-ui/jquery-ui.min.js"></script>

<!-- Jvectormap -->
<script src="https://cruz.site44.com/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
<script src="https://cruz.site44.com/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

<!-- Sparkline -->
<script src="https://cruz.site44.com/js/plugins/sparkline/jquery.sparkline.min.js"></script>

<!-- ChartJS-->
<script src="https://cruz.site44.com/js/plugins/chartJs/Chart.min.js"></script>

<!-- CodeMirror-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/mode/javascript/javascript.js"></script>

<!-- FirebaseJS-->
<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<script>
firebase.initializeApp({apiKey: "AIzaSyApJBfnH0j3TSugzEABiMFkI_tU_XXeGzg", authDomain: "shippy-ac235.firebaseapp.com", databaseURL: "https://shippy-ac235.firebaseio.com"});
</script>
<script src="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src='https://cruzco.site44.com/lib/moment.min.js'></script>
<script src='http://isaaccambron.com/twix.js/twix.js/dist/twix.min.js'></script>
<script src='https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js'></script>
<script src="https://cruz.site44.com/js/plugins/dataTables/datatables.min.js"></script>
<script src="https://cruzco.site44.com/js/plugins/fullcalendar/fullcalendar.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/api/sum().js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/sorting/datetime-moment.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/vderm9/jutility/master/js/dataTables.editor.min.js"></script>
<link href="https://cruz.site44.com/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cruz.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
<link href="https://cruz.site44.com/css/animate.css" rel="stylesheet">
<link href="https://cruz.site44.com/css/style.css" rel="stylesheet">
<script src="https://rawgit.com/vderm9/jutility/master/jutility.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.1.0/webcomponents-hi.js"></script>
<!-- <script src="https://rawgit.com/ChrisCruze/jutility/master/jutility.js"></script>
 -->
 <script src="jutility.js"></script>

</head>

<body>

<div id="wrapper">
<div id="page-wrapper2" class="gray-bg" style="min-height: 305px;">
<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">
    <h2>Goals</h2>
    </div>
</div>
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row">
    <div class="col-lg-12">
    <div class="ibox float-e-margins">
    <div class="ibox-content">







    <div class="row" id="metric_headers">
    </div>









    </div>
    </div>
    </div>
    </div>

<div class="row">
                            <div class="col-lg-4">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>Needed Tasks</h5>
                                        <div class="ibox-tools">
                                            <a class="collapse-link">
                                                <i class="fa fa-chevron-up"></i>
                                            </a>
                                            <a class="close-link">
                                                <i class="fa fa-times"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="ibox-content">
                                        <table class="table table-hover no-margins" id="table">
                                        </table>
                                    </div>
                                </div>
                            </div>

                        </div>


</div>
</div>
</div>
<script>



//pull todoist, gspread, etc
todoist_gspread_pull = todoist_tasks_pull_custom_gspread()
gspread_array = todoist_gspread_pull.gspread

var dbRef = dbRef||firebase.database();
var snapshot_ref = dbRef.ref('todoist_snapshots').child('gspread_recurring_tasks').child(moment().format("YYYYMMDD"))
snapshot_ref.set(gspread_array)


function percentage_complete_metric_generate(gspread_array){
  complete_array = gspread_array.filter(function(D){return D.status == 'Green'})
  percentage_complete = (complete_array.length/gspread_array.length)*100
  title_text = 'Percentage Complete'
  metric_text = percentage_complete.toFixed(1) + "%"
  sub_title = '-'
  sub_metric_text = complete_array.length + "/" + gspread_array.length
  $('#metric_headers').append(metric_header_create(title_text,sub_title,metric_text,sub_metric_text))
}

percentage_complete_metric_generate(gspread_array)


dt = $("#table").DataTable({
  paging: false,
  dom: '<"html5buttons"B>lTfgitp',
  data: gspread_array,
  columns:[
    {data:'Task',title:'Task',name:'Task'},
    {data:'status',title:'status',name:'status',visible:false},

    ],
  select: true,
  colReorder: true,
  buttons: [
    { extend: "excel", title: document.title },
    { extend: "colvis", title: document.title }
  ],
  order: [0, "desc"]
});



dt.columns('status:name').search('^((?!Green).)*$',true,false).draw()









</script>
</div>
</body>
</html>