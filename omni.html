<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cruz Control</title>
<link href="https://cruz.site44.com/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cruz.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
<link href="https://cruz.site44.com/css/animate.css" rel="stylesheet">
<link href=https://rawgit.com/vderm9/jutility/master/style.css rel="stylesheet">
<link href='https://cruzco.site44.com/lib/fullcalendar.min.css' rel='stylesheet' />
<link href='https://cruzco.site44.com/lib/fullcalendar.print.min.css' rel='stylesheet' media='print' />
<link href='https://cruzco.site44.com/lib/scheduler.min.css' rel='stylesheet' />
<link href='https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css' rel='stylesheet' />
<link href="https://cruz.site44.com/css/plugins/dataTables/datatables.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css"/>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.css" />
<link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />
<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
<link rel="stylesheet" href="https://cdn.rawgit.com/vderm9/jutility/master/css/editor.dataTables.min.css">
<!-- Mainly scripts -->
<script src="https://cruz.site44.com/js/jquery-3.1.1.min.js"></script>
<script src="https://cruz.site44.com/js/bootstrap.min.js"></script>
<script src="https://cruz.site44.com/js/plugins/metisMenu/jquery.metisMenu.js"></script>
<script src="https://cruz.site44.com/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

<!-- Flot -->
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.spline.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.resize.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.pie.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/jquery.flot.symbol.js"></script>
<script src="https://cruz.site44.com/js/plugins/flot/curvedLines.js"></script>

<!-- Peity -->
<script src="https://cruz.site44.com/js/plugins/peity/jquery.peity.min.js"></script>
<script src="https://cruz.site44.com/js/demo/peity-demo.js"></script>

<!-- Custom and plugin javascript -->
<script src="https://cruz.site44.com/js/inspinia.js"></script>
<script src="https://cruz.site44.com/js/plugins/pace/pace.min.js"></script>

<!-- jQuery UI -->
<script src="https://cruz.site44.com/js/plugins/jquery-ui/jquery-ui.min.js"></script>

<!-- Jvectormap -->
<script src="https://cruz.site44.com/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
<script src="https://cruz.site44.com/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

<!-- Sparkline -->
<script src="https://cruz.site44.com/js/plugins/sparkline/jquery.sparkline.min.js"></script>

<!-- ChartJS-->
<script src="https://cruz.site44.com/js/plugins/chartJs/Chart.min.js"></script>

<!-- CodeMirror-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/mode/javascript/javascript.js"></script>

<!-- FirebaseJS-->
<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<script>
firebase.initializeApp({apiKey: "AIzaSyApJBfnH0j3TSugzEABiMFkI_tU_XXeGzg", authDomain: "shippy-ac235.firebaseapp.com", databaseURL: "https://shippy-ac235.firebaseio.com"});
</script>
<script src="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.js"></script>
<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src='https://cruzco.site44.com/lib/moment.min.js'></script>
<script src='http://isaaccambron.com/twix.js/twix.js/dist/twix.min.js'></script>
<script src='https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js'></script>
<script src="https://cruz.site44.com/js/plugins/dataTables/datatables.min.js"></script>
<script src="https://cruzco.site44.com/js/plugins/fullcalendar/fullcalendar.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/api/sum().js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/sorting/datetime-moment.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/vderm9/jutility/master/js/dataTables.editor.min.js"></script>
<link href="https://cruz.site44.com/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cruz.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
<link href="https://cruz.site44.com/css/animate.css" rel="stylesheet">
<link href="https://cruz.site44.com/css/style.css" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

<script src="https://rawgit.com/vderm9/jutility/master/jutility.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.1.0/webcomponents-hi.js"></script>
<!-- <script src="https://rawgit.com/ChrisCruze/jutility/master/jutility.js"></script>
 -->
 <script src="jutility.js"></script>

</head>
<body>
<div id="wrapper">
<div id='navigation_side'></div>

<div id="page-wrapper2" class="gray-bg">
<div class="row border-bottom">
        <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">



            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " id="timer_text" data-toggle="dropdown" class="btn btn-white dropdown-toggle" type="button" aria-expanded="false" href="#"><i class="fa fa-bars"></i> </a>

            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " id="favicon_select_button" data-toggle="dropdown" class="btn btn-white dropdown-toggle" type="button" aria-expanded="false" href="#"><i class="fa fa-bars"></i> </a>
            <ul class="dropdown-menu" id="favicon_dropdown_menu">
                <li><small id='task_content'></small></li>
            </ul>   




            <form role="search" class="navbar-form-custom" action="search_results.html" style="width: 400px;">

                <div class="form-group">
                    <input size="80" placeholder="Task" class="form-control" name="top-search" id="input_text" type="text">
                </div>
            </form>
        </div>
            <ul class="nav navbar-top-links navbar-right">
                <li>
                    <a id='input_start'>
                        <i class="fa fa-tasks"></i> Start
                    </a>
                </li>
                <li>
                    <a id='input_create'>
                        <i class="fa fa-tasks"></i> Create
                    </a>
                </li>
                <li>
                    <a id='input_update'>
                        <i class="fa fa-tasks"></i> Update
                    </a>
                </li>
                <li>
                    <a id='input_complete'>
                        <i class="fa fa-tasks"></i> Complete
                    </a>
                </li>
                <li>
                    <a id='input_delete'>
                        <i class="fa fa-tasks"></i> Delete
                    </a>
                </li>
                <li>
                    <a id='sync_todoist'>
                        <i class="fa fa-tasks"></i> Sync
                    </a>
                </li>
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell"></i> Filters 
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">
                        <li>
                            <a href="mailbox.html">
                                <div>
                                    <i class="fa fa-envelope fa-fw"></i> You have 16 messages
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                    </ul>
                </li>


                <li>
                    <a class="right-sidebar-toggle">
                        <i class="fa fa-tasks"></i>
                    </a>
                </li>
            </ul>

        </nav>
        </div>

<div class="wrapper wrapper-content">
<div id='main_content'>
<div class="container">
        <div class="row" id="metric_headers">


        </div>
        <div class="row">
            <div class="col-lg-8">
                <div class="ibox float-e-margins">
                    <div class="ibox-content">
                        <div>
                                        <span class="pull-right text-right">
                                        <small></small>
                                        </span>
                            <h3 class="font-bold no-margins">
                                Tasks Over Time
                            </h3>
                            <small></small>
                        </div>

                        <div class="m-t-sm">

                            <div class="row">
                                <div class="col-md-8">
                                    <div>
                                        <canvas id="barChart" height="114"></canvas>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <canvas id="horizontalbarChart" ></canvas>
                                </div>
                            </div>

                        </div>

                        <div class="m-t-md">
                            <small class="pull-right">
                                <i class="fa fa-clock-o"> </i>
                            </small>
                            <small>
                            </small>
                        </div>

                    </div>
                </div>
            </div>

        </div>

                        <div class="row">

                            <div class="col-lg-4">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>Needed Tasks</h5>
                                        <div class="ibox-tools">
                                            <a class="collapse-link">
                                                <i class="fa fa-chevron-up"></i>
                                            </a>
                                            <a class="close-link">
                                                <i class="fa fa-times"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="ibox-content">
                                        <table class="table table-hover no-margins" id="remaining_tasks_table">
                                        </table>
                                    </div>
                                </div>
                            </div>


                            <div class="col-lg-4">
                                <div class="ibox float-e-margins">
                                    <div class="ibox-title">
                                        <h5>Remaining Tasks To Be Completed</h5>
                                        <div class="ibox-tools">
                                            <a class="collapse-link">
                                                <i class="fa fa-chevron-up"></i>
                                            </a>
                                            <a class="close-link">
                                                <i class="fa fa-times"></i>
                                            </a>
                                        </div>
                                    </div>
                                    <div class="ibox-content">
                                        <ul class="todo-list m-t small-list">
                                            <li>
                                                <a href="#" class="check-link"><i class="fa fa-check-square"></i> </a>
                                                <span class="m-l-xs todo-completed">Buy a milk</span>

                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                        </div>



            <div class="row" style="display:none">
                <div class="col-lg-4">
                <div id='end_of_day_review'>
                    <div class="ibox">
                        <div class="ibox-content">
                            <div class="text-center article-title">
                                <h3 id="blog_title">
                                    End of Day Review
                                </h3>
                                <div class="small m-b-xs">
                                    What went well (instead of what went wrong)? How will I improve?
                                </div>
                                <span class='text_content'></span>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-white btn-xs edit_content"  type="button">edit</button>
                                </div>
                                <div class="col-md-6">
                                    <div class="small text-right">
                            <span class="text-muted timestamp" ><i class="fa fa-clock-o"></i> </span>
                            <input type="text" class='date_picker_calendar' />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ibox-footer markdown_edit_form" style='display:none'>
                             What went well (instead of what went wrong)? 
                             How will I improve? 
                                <textarea style="resize: none;" class="md-input markdown_area" name="content" data-provide="markdown" rows="10">
                                </textarea><div class="md-fullscreen-controls"><a href="#" class="exit-fullscreen" title="Exit fullscreen">
                                <span class="glyphicon glyphicon-fullscreen"></span></a></div>
                        </div>
                    </div>
                </div>
                </div>
                <div class="col-lg-4">
                <div id='morning_review'>
                    <div class="ibox">
                        <div class="ibox-content">
                            <div class="text-center article-title">
                                <h3 id="blog_title">
                                    Morning Review
                                </h3>
                                <div class="small m-b-xs">
                                    What are your top three to five priorities?
                                </div>
                                <span class='text_content'></span>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <button class="btn btn-white btn-xs edit_content" type="button">edit</button>
                                </div>
                                <div class="col-md-6">
                                    <div class="small text-right">
                            <span class="text-muted timestamp" ><i class="fa fa-clock-o"></i> </span>
                            <input type="text" class='date_picker_calendar' />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="ibox-footer markdown_edit_form" style='display:none'>
                             What went well (instead of what went wrong)? 
                                <textarea style="resize: none;"  class="md-input markdown_area" name="content" data-provide="markdown" rows="10">
                                </textarea><div class="md-fullscreen-controls"><a href="#" class="exit-fullscreen" title="Exit fullscreen">
                                <span class="glyphicon glyphicon-fullscreen"></span></a></div>
                        </div>

                    </div>
                </div>
                </div>
            </div>


        <div class="row">

        <div class="col-lg-12">
        <div class="ibox float-e-margins">
        <div class="ibox-title">
            <h5>Todoist Tasks </h5>
            <div class="ibox-tools">
                <a class="collapse-link">
                    <i class="fa fa-chevron-up"></i>
                </a>
                <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                    <i class="fa fa-wrench"></i>
                </a>
                <ul class="dropdown-menu dropdown-user">
                    <li><a href="#">Config option 1</a>
                    </li>
                    <li><a href="#">Config option 2</a>
                    </li>
                </ul>
                <a class="close-link">
                    <i class="fa fa-times"></i>
                </a>
            </div>
        </div>
        <div class="ibox-content">
            <div class="row">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#tab-1" data-toggle="tab">Current Tasks</a></li>
                    <li class=""><a href="#tab-2" data-toggle="tab">Completed Tasks</a></li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane active" id="tab-1">
                        <table id="current_tasks_table" class="display" cellspacing="0" width="100%"></table>
                    </div>
                    <div class="tab-pane" id="tab-2">
                        <table id="completed_tasks_table" class="display" cellspacing="0" width="100%"></table>

                    </div>
                </div>


            </div>


        </div>
        </div>
        </div>

        </div>




</div>
</div>
</div>


</div>
</div>



<script>


var dbRef = dbRef||firebase.database();
omni_node = 'todoist_tasks'
var FirebaseRef = dbRef.ref('omni').child(omni_node)
var timer_instance = dbRef.ref('omni').child('timer_instance')
var snapshot_instance = dbRef.ref('omni').child('snapshot')

try{
    todoist_gspread_pull = todoist_tasks_pull_custom_gspread()
}
catch {
    todoist_gspread_pull = firebase_json_pull("https://shippy-ac235.firebaseio.com/omni/snapshot.json")
}

$("#sync_todoist").click(function(event) {
    todoist_gspread_pull = todoist_tasks_pull_custom_gspread()
    snapshot_instance.set(todoist_gspread_pull)
    toastr_notification("Todoist Synced")
})


projects_dictionary = todoist_gspread_pull.projects
gspread_array = todoist_gspread_pull.gspread
current_tasks = todoist_gspread_pull.todoist_current
completed_tasks = todoist_gspread_pull.todoist_completed



header_metrics_create_todoist()


percentage_complete_metric_generate(gspread_array)





bar_chart_object = bar_chart_initiate_render_chartjs("barChart")
function completed_tasks_callback_wrapper(callback_array){
    metric_func = null
    color_func = null
    function date_func(i){return moment(i).format("MM/DD")}


    bar_chart_update_time_scale_calculate_function(bar_chart_object,callback_array,'completed_date',metric_func)

    return completed_tasks_call_back(callback_array)
}
horizontal_bar_chart_initiate_render_chartjs("horizontalbarChart")



remaining_tasks_populate(gspread_array)
todoist_table_create_current(current_tasks,"#current_tasks_table",current_tasks_call_back)
todoist_table_create_complete(completed_tasks,"#completed_tasks_table",completed_tasks_callback_wrapper)

















timer_instance.on('value', function(snapshot) {
    timer_instance_dictionary = snapshot.val()
    if (timer_instance_dictionary != null){
        console.log(timer_instance_dictionary)
        timer_instance_exists_process(timer_instance_dictionary,timer_instance)
    }
      else {
    }
});

//task_create_todoist('test',2159934072)
$("#input_create").click(function(event) {
    event.preventDefault()
    project_id = $("#favicon_select_button").find('.favicon_select').attr('id')
    content = $("#input_text").val()
    start_time = moment().format()
  function create_task_promise(input) {
    return new Promise(function(resolve, reject) {
      result = todoist_add_tasks_ajax("a14f98a6b546b044dbb84bcd8eee47fbe3788671",input)
      resolve(result)
    });}

  create_task_promise({"content": content, "project_id": project_id}).then(function(r) {
    task_id = Object.values(r.temp_id_mapping)[0]
    upload_dictionary = {
        start_time: moment().format(),
        id: task_id,
        task_id: task_id,
        content:content,
        project_id:project_id
    }
    timer_instance.set(upload_dictionary)
  });
});


$("#current_tasks_table").on("click", "tbody td", function(e) {
  var table = $("#current_tasks_table").DataTable();
  row_data = table.row(this).data();
  $("#input_text").val(row_data.content)
  $("#input_text").attr('task_id',row_data.id)
  $("#input_text").attr('project_id',row_data.project_id)
});


//task_create_todoist('test',2159934072)
$("#input_start").click(function(event) {
    content = $("#input_text").val()
    project_id = $("#input_text").attr('project_id')
    task_id = $("#input_text").attr('task_id')
    upload_dictionary = {
        start_time: moment().format(),
        id: task_id,
        task_id: task_id,
        content:content,
        project_id:project_id
    }
    timer_instance.set(upload_dictionary)
});


create_project_dropdown_list(projects_dictionary)


</script>

</body>
</html>