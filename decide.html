<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Cruz Control</title>
		<link href="https://cruzco.site44.com/css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cruzco.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
		<link href="https://cruzco.site44.com/css/animate.css" rel="stylesheet">
		<link href="https://cruzco.site44.com/css/plugins/bootstrap-markdown/bootstrap-markdown.min.css" rel="stylesheet">
		<link href='https://rawgit.com/vderm9/jutility/master/style.css' rel="stylesheet">
		<link href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.css' rel='stylesheet' />
		<link href='https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.print.min.css' rel='stylesheet' media='print' />
		<link href='https://cruzco.site44.com/lib/scheduler.min.css' rel='stylesheet' />
		<link href='https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css' rel='stylesheet' />
		<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
		<link href="https://cruzco.site44.com/css/plugins/dataTables/datatables.min.css" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.css"/>
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css"/>
		<link href="https://cruzco.site44.com/css/plugins/daterangepicker/daterangepicker-bs3.css" rel="stylesheet">
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/metisMenu/2.7.9/metisMenu.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.css" />
		<link rel="stylesheet" href="https://cdn.firebase.com/libs/firepad/1.4.0/firepad.css" />
		<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css">
		<link rel="stylesheet" href="https://cdn.rawgit.com/vderm9/jutility/master/css/editor.dataTables.min.css">
		<link rel="stylesheet" href="https://cdn.rawgit.com/ChrisCruze/jutility/master/libs/jquery.dataTables.yadcf.css">
		<link rel="stylesheet" href="css/small_chat.css">
		<!-- Mainly scripts -->
		<script src="https://cruzco.site44.com/js/jquery-3.1.1.min.js"></script>
		<script src="https://cruzco.site44.com/js/bootstrap.min.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/metisMenu/jquery.metisMenu.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
		<!-- Flot -->
		<script src="https://cruzco.site44.com/js/plugins/flot/jquery.flot.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/flot/jquery.flot.tooltip.min.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/flot/jquery.flot.spline.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/flot/jquery.flot.resize.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/flot/jquery.flot.pie.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/flot/jquery.flot.symbol.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/flot/curvedLines.js"></script>
		<!-- Peity -->
		<script src="https://cruzco.site44.com/js/plugins/peity/jquery.peity.min.js"></script>
		<script src="https://cruzco.site44.com/js/demo/peity-demo.js"></script>
		<!-- Custom and plugin javascript -->
		<script src="https://cruzco.site44.com/js/inspinia.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/pace/pace.min.js"></script>
		<!-- jQuery UI -->
		<script src="https://cruzco.site44.com/js/plugins/jquery-ui/jquery-ui.min.js"></script>
		<!-- Jvectormap -->
		<script src="https://cruzco.site44.com/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
		<!-- Sparkline -->
		<script src="https://cruzco.site44.com/js/plugins/sparkline/jquery.sparkline.min.js"></script>
		<!-- ChartJS-->
		<script src="https://cruzco.site44.com/js/plugins/chartJs/Chart.min.js"></script>
		<!-- CodeMirror-->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/codemirror.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/mode/javascript/javascript.js"></script>
		<!-- FirebaseJS-->
		<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
		<script>
		firebase.initializeApp({apiKey: "AIzaSyApJBfnH0j3TSugzEABiMFkI_tU_XXeGzg", authDomain: "shippy-ac235.firebaseapp.com", databaseURL: "https://shippy-ac235.firebaseio.com"});
		</script>
		<script src="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.js"></script>
		<link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/2.6.2/firebaseui.css" />
		<!-- Bootstrap markdown -->
		<script src="https://cruzco.site44.com/js/plugins/bootstrap-markdown/bootstrap-markdown.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/bootstrap-markdown/markdown.js"></script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js'></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
		<script src='https://cruzco.site44.com/lib/moment.min.js'></script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/moment-duration-format/2.2.2/moment-duration-format.min.js
		'></script>
		<script src='http://isaaccambron.com/twix.js/twix.js/dist/twix.min.js'></script>
		<script src='https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js'></script>
		<script src="https://cruzco.site44.com/js/plugins/dataTables/datatables.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/pdfmake.min.js"></script>
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.32/vfs_fonts.js"></script>
		<script type="text/javascript" src="https://cdn.datatables.net/v/bs/jszip-2.5.0/dt-1.10.16/af-2.2.2/b-1.5.1/b-colvis-1.5.1/b-flash-1.5.1/b-html5-1.5.1/b-print-1.5.1/cr-1.4.1/fc-3.2.4/fh-3.1.3/kt-2.3.2/r-2.2.1/rg-1.0.2/rr-1.2.3/sc-1.4.4/sl-1.2.5/datatables.min.js"></script>
		<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/api/sum().js"></script>
		<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.16/sorting/datetime-moment.js"></script>
		<script type="text/javascript" src="https://cdn.rawgit.com/vderm9/jutility/master/js/dataTables.editor.min.js"></script>
		<link href="https://cruzco.site44.com/css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cruzco.site44.com/font-awesome/css/font-awesome.css" rel="stylesheet">
		<link href="https://cruzco.site44.com/css/animate.css" rel="stylesheet">
		<link href="https://cruzco.site44.com/css/style.css" rel="stylesheet">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
		<script src="https://cdn.rawgit.com/ChrisCruze/jutility/master/libs/jquery.dataTables.yadcf.js"></script>
		<script src="https://cruzco.site44.com/js/plugins/daterangepicker/daterangepicker.js"></script>
		<script src="https://rawgit.com/vderm9/jutility/master/jutility.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/1.1.0/webcomponents-hi.js"></script>
		<!-- <script src="https://rawgit.com/ChrisCruze/jutility/master/jutility.js"></script>
		-->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.0/sweetalert.min.js"></script>
		<!--   <script src="https://cdnjs.cloudflare.com/ajax/libs/sass.js/0.10.10/sass.min.js"></script>
		-->
		<script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="gb3pnnrxyrysbbu"></script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
		<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
		<script src="jutility.js"></script>
		<style>
		#customForm {
		display: flex;
		flex-flow: row wrap;
		}
		
		#customForm fieldset {
		flex: 1;
		border: 1px solid #aaa;
		margin: 0.5em;
		}
		
		#customForm fieldset legend {
		padding: 5px 20px;
		border: 1px solid #aaa;
		font-weight: bold;
		}
		
		#customForm fieldset.name {
		flex: 2 100%;
		}
		
		#customForm fieldset.name legend {
		background: #bfffbf;
		}
		
		#customForm fieldset.office legend {
		background: #ffffbf;
		}
		
		#customForm fieldset.hr legend {
		background: #ffbfbf;
		}
		
		#customForm div.DTE_Field {
		padding: 5px;
		}
		.btn-xlarge {
		padding: 18px 28px;
		font-size: 22px; //change this to your desired size
		line-height: normal;
		-webkit-border-radius: 8px;
		-moz-border-radius: 8px;
		border-radius: 8px;
		}
		</style>
	</head>
	<body>
		<div id="wrapper">
			<div class="wrapper wrapper-content">
				<div id='main_content'>
					
	<div class="row">
	<div class="col-lg-6">


					<div class="container" style="    width:50%;
						position:fixed;">
						<button id='lap_button_accept' type="button" class="btn btn-primary center btn-block just" style="width:100%;height:50%;font-size: 20vw;">Accept</button>
						<p class='text-center ' id='time_since'></p>
					</div>
	</div>
	<div class="col-lg-6">

					<div class="container" style="    width:50%;
						position:fixed;">
						<button id='lap_button_deny' type="button" class="btn btn-danger center btn-block just" style="width:100%;height:50%;font-size: 20vw;">Deny</button>
						<p class='text-center ' id='time_since'></p>
					</div>
	</div>
	</div>
					<!-- 	<table id="table" class="display" cellspacing="0" width="100%">
						-->
						<div class="row">
							<div class="col-lg-12">
								<div class="ibox float-e-margins">
									<div class="ibox-content text-center">
										<table id="table" class="display" cellspacing="0" width="100%">
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<script>
			var dbRef = firebase.database();
			var contactsRef = dbRef.ref('decide');
			$.fn.dataTable.ext.type.order['moment-date-format-pre'] = function ( d ) {
			return moment(d).utc();
			};
			//push data about the checkbox to firebase
			$("#lap_button_accept").click(function(event) {
			// input_text = $("#drogas_input").val()
			date_time = moment().format(); //new Date()
			data_to_push = {'date_time':date_time,'type':'accept'}
			contactsRef.push(data_to_push)
			});
			$("#lap_button_deny").click(function(event) {
			// input_text = $("#drogas_input").val()
			date_time = moment().format(); //new Date()
			data_to_push = {'date_time':date_time,'type':'Deny'}
			contactsRef.push(data_to_push)
			});
			function callback_function(){
			var api = this.api();
			array = api.column("date_time:name", {page:'current'} ).data()
			//var array = this.api().data();
			//array = api.column("date_time:name", {page:'current'} ).data()
			//array = array.filter(function(D){return moment(D['date_time']) > moment().subtract(4, 'hours').from(moment())})
			filtered_array = array.filter(function(D){return moment(D) > moment().subtract(10, 'minutes').from(moment())})
			//console.log(array)
			//.sum()
			}
			function cell_process_func(td, cellData, rowData, row, col){
				return moment(cellData).format("YYYY-MM-DD hh:mm a")
			}
			table = $('#table').DataTable({
						paging:false,
						dom: '<"html5buttons"B>lTfgitp',
						data: [],
						columns: [
							{data:'date_time_formatted',title:'date_time',visible:true,name:'date_time'},
							{data:'type',title:'type',visible:true,name:'type'},
						],
						select: true,
						colReorder: true,
						order: [[ 0, "desc" ]],
						buttons: [
							{extend: 'excel', title: document.title},
							{extend: 'colvis', title: document.title}
						]
					});
			full_array = []
			last_time_stamp = moment()
			contactsRef.on("child_added", function(snap) {
			dictionary_obj = snap.val()
			dictionary_obj['date_time_formatted'] = moment(dictionary_obj['date_time']).format("YYYY-MM-DD hh:mm:ss a")
			new_time_stamp = last_time_stamp.clone()
			time_since = moment.utc(moment(dictionary_obj['date_time']).diff(new_time_stamp )).format("HH:mm:ss")
			dictionary_obj['time_since'] = time_since
			$("#time_since").html(time_since)
			console.log(dictionary_obj)
			last_time_stamp = moment(dictionary_obj['date_time'])
			table.row.add(dictionary_obj).draw( false );
			full_array.push(dictionary_obj)
			filtered_array = full_array.filter(function(D){return moment(D['date_time']) > moment().subtract(180, 'minutes')})
			$("#lap_button").html(filtered_array.length)
			})
			var timeoutId = 0;
			function myFunction(){
				alert('helo down')
			}
			$('#lap_button').on('mousedown', function() {
			timeoutId = setTimeout(myFunction, 1000);
			}).on('mouseup mouseleave', function() {
			clearTimeout(timeoutId);
			});
			replace_side_panel_platform_omni
			</script>
		</body>
	</html>